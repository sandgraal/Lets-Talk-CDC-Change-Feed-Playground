{
  "id": "orders-items-transactions",
  "name": "Orders + Items Transactions",
  "description": "Teaching multi-table commit semantics.",
  "tags": [
    "transactions",
    "orders"
  ],
  "schema": [
    {
      "name": "id",
      "type": "string",
      "pk": true
    },
    {
      "name": "customer_id",
      "type": "string",
      "pk": false
    },
    {
      "name": "status",
      "type": "string",
      "pk": false
    },
    {
      "name": "subtotal",
      "type": "number",
      "pk": false
    },
    {
      "name": "shipped_ts",
      "type": "number",
      "pk": false
    }
  ],
  "rows": [
    {
      "id": "ORD-720",
      "customer_id": "C-32",
      "status": "shipped",
      "subtotal": 412.5,
      "shipped_ts": 520
    }
  ],
  "ops": [
    {
      "t": 300,
      "op": "insert",
      "table": "orders",
      "pk": {
        "id": "ORD-720"
      },
      "after": {
        "customer_id": "C-32",
        "status": "pending",
        "subtotal": 412.5
      },
      "txn": {
        "id": "TX-720",
        "index": 0,
        "total": 3
      }
    },
    {
      "t": 300,
      "op": "insert",
      "table": "order_items",
      "pk": {
        "id": "ORD-720-1"
      },
      "after": {
        "order_id": "ORD-720",
        "sku": "SKU-9",
        "qty": 2,
        "price": 99.5
      },
      "txn": {
        "id": "TX-720",
        "index": 1,
        "total": 3
      }
    },
    {
      "t": 300,
      "op": "insert",
      "table": "order_items",
      "pk": {
        "id": "ORD-720-2"
      },
      "after": {
        "order_id": "ORD-720",
        "sku": "SKU-44",
        "qty": 1,
        "price": 213.5
      },
      "txn": {
        "id": "TX-720",
        "index": 2,
        "total": 3,
        "last": true
      }
    },
    {
      "t": 520,
      "op": "update",
      "table": "orders",
      "pk": {
        "id": "ORD-720"
      },
      "after": {
        "status": "shipped",
        "shipped_ts": 520
      }
    }
  ]
}